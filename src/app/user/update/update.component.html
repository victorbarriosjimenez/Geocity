<app-navigation></app-navigation>
<header>  
</header>
<div class="container">
    <h2>Editar perfil </h2>
    <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <p class="user-details">
              Información general
            </p>
          </mat-panel-title>
          <mat-panel-description>
            <div *ngIf="user && user.editionRequests < 3; else showAlert"> 
                Tienes  {{ 3 - user.editionRequests }} oportunidades para editar tu perfil
            </div>
            <ng-template #showAlert class="alert alert-danger">
                Has agotado tus oportunidades para editar tu perfil
            </ng-template>
          </mat-panel-description>
        </mat-expansion-panel-header>  
        <div *ngIf="user && user.editionRequests < 3; else showDisclaimerToLogout" class="row">
            <div class="col-md-6 col-xs-12 col-sm-6">
              <h3>Modifica tu información general </h3>
              <form (ngSubmit)="sendsUserUpdateForm( )" [formGroup]="userUpdateForm">     
                    <mat-form-field class="full-width">
                            <input 
                                matInput
                                type="text"
                                placeholder="Nombre de Usuario"
                                formControlName="username">
                    </mat-form-field> 
                    <mat-form-field class="full-width">
                        <input 
                            matInput
                            type="text"
                            placeholder="Foto de perfil"
                            formControlName="profilePhotoUrl">
                    </mat-form-field> 
                    <mat-form-field class="full-width">
                      <mat-select placeholder="Pais de Origen" formControlName="country">
                        <mat-option *ngFor="let country of countries" [value]="country.name">
                            {{ country.name }}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <button mat-raised-button type="submit" color="primary">Guardar cambios</button>
                </form>
            </div>  
            <div class="col-md-6 col-xs-12 col-sm-6">
                <div>
                     <img  src="{{ userUpdateForm.value.profilePhotoUrl }}" alt="">
                </div>
                <div class="user-details">
                      <p>
                        <span>Username:</span> {{ userUpdateForm.value.username }}
                      </p>     
                      <p> 
                        <span>País de origen:</span>  {{ userUpdateForm.value.country }}                          
                      </p>         
                </div>
            </div> 
        </div>
        <ng-template #showDisclaimerToLogout>
          <div style="border-radius: 0px;" class="text-center alert alert-danger">
            <p>
              Geocity solo permite un total de 3 modificaciones de tu perfil por sesión. 
              <strong> 
                  ¡Cierra tu sesión actual y vuelve a entrar para modificar tu perfil!
              </strong>
            </p>
            <br>
            <button style="display: flex; margin: 0 auto;" mat-raised-button color="warn">
                Salir de Geocity
            </button>
          </div>
        </ng-template>
      </mat-expansion-panel>
  <h2>Cambiar contraseña</h2>    
  <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <p class="user-details">
            Cambiar contraseña
          </p>
        </mat-panel-title>
        <mat-panel-description>
           Enviar a formulario a mi correo 
        </mat-panel-description>
      </mat-expansion-panel-header>
       <div style="border-radius: 0px;" class="text-center alert alert-info">
          <p>
              Geocity enviará un correo para el cambio de tu contraseña.
              Si estás seguro <strong>pulsa el siguente botón para hacer el envío</strong> y
              nos pondremos en contacto contigo.
          </p>
          <br>
          <button style="display: block; margin: 0 auto;" 
                  mat-raised-button 
                  color="accent"
                  (click)="sendPasswordResetEmail()">
                  Enviar correo de confirmación
          </button>
        </div>
    </mat-expansion-panel>
    <h2>Eliminar mi cuenta</h2>    
    <mat-expansion-panel color="warn">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <p class="user-details">
              Salirme de Geocity
            </p>
          </mat-panel-title>
          <mat-panel-description>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div style="border-radius: 0px;" class="text-center alert alert-danger">
            <p> 
                <strong>¡Cuidado!</strong> Al pulsar este botón tu cuenta será eliminida permanentemente
                <br>
            </p>
            <button style="display: flex; margin: 0 auto;" mat-raised-button color="warn">Eliminar mi cuenta</button>            
        </div>
      </mat-expansion-panel>
</div>